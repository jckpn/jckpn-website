<!DOCTYPE html>

<html lang="en" data-content_root="./">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Blocks &#8212; lmblocks  documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=5ecbeea2" />
    <link rel="stylesheet" type="text/css" href="_static/basic.css?v=686e5160" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css?v=27fed22d" />
    <script src="_static/jquery.js?v=5d32c60e"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
    <script src="_static/documentation_options.js?v=5929fcd5"></script>
    <script src="_static/doctools.js?v=9bcbadda"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Stop Criteria" href="stop_criteria.html" />
    <link rel="prev" title="Decoding Strategies" href="decoding_strategies.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="blocks">
<h1>Blocks<a class="headerlink" href="#blocks" title="Link to this heading"></a></h1>
<section id="module-lmblocks.blocks.base">
<span id="base"></span><h2>Base<a class="headerlink" href="#module-lmblocks.blocks.base" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="lmblocks.blocks.base.BlockSequence">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">BlockSequence</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">blocks</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">draw_border</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lmblocks.blocks.base.BlockSequence" title="Link to this definition"></a></dt>
<dd><p>Contains a mutable sequence of blocks, applied in the given order.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>blocks</strong> (<em>list</em><em>[</em><em>Block</em><em>]</em>) – The blocks to apply in order.</p></li>
<li><p><strong>draw_border</strong> (<em>bool</em>) – Whether to draw a border around the sequence in the graph.</p></li>
</ul>
</dd>
<dt class="field-even">Keyword Arguments<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>num_repeats</strong> (<em>int</em>) – Number of times to run the sequence. Defaults to 1.</p></li>
<li><p><strong>repeat_until</strong> (<em>StopCriterion</em><em> | </em><em>None</em>) – If set, the block and all inner methods will be repeated until the criterion is met.</p></li>
<li><p><strong>for_all_batches</strong> (<em>bool</em>) – If True, the block will be applied to all batches when given a list input.</p></li>
<li><p><strong>for_batch_idx</strong> (<em>bool</em><em> | </em><em>None</em>) – The index of the batch to apply the block to when given a list input.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="lmblocks.blocks.base.BlockSequence.label">
<span class="sig-name descname"><span class="pre">label</span></span><a class="headerlink" href="#lmblocks.blocks.base.BlockSequence.label" title="Link to this definition"></a></dt>
<dd><p>The label shown on the graph. Updates dynamically with parameter changes.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">All</span> <span class="pre">parameters</span> <span class="pre">and</span> <span class="pre">arguments</span> <span class="pre">are</span> <span class="pre">also</span> <span class="pre">exposed</span> <span class="pre">as</span> <span class="pre">attributes,</span> <span class="pre">so</span> <span class="pre">they</span> <span class="pre">can</span> <span class="pre">be</span> <span class="pre">modified</span> <span class="pre">after</span> <span class="pre">initialization.</span></span></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-lmblocks.blocks.tokens_and_logits">
<span id="tokens-and-logits"></span><h2>Tokens and Logits<a class="headerlink" href="#module-lmblocks.blocks.tokens_and_logits" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="lmblocks.blocks.tokens_and_logits.GetMaxNextToken">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">GetMaxNextToken</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lmblocks.blocks.tokens_and_logits.GetMaxNextToken" title="Link to this definition"></a></dt>
<dd><p>Increases the sequence length by 1 by selecting the token with the highest
logit.</p>
<dl class="field-list simple">
<dt class="field-odd">Keyword Arguments<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>num_repeats</strong> (<em>int</em>) – Number of times to run the sequence. Defaults to 1.</p></li>
<li><p><strong>repeat_until</strong> (<em>StopCriterion</em><em> | </em><em>None</em>) – If set, the block and all inner methods will be repeated until the criterion is met.</p></li>
<li><p><strong>for_all_batches</strong> (<em>bool</em>) – If True, the block will be applied to all batches when given a list input.</p></li>
<li><p><strong>for_batch_idx</strong> (<em>bool</em><em> | </em><em>None</em>) – The index of the batch to apply the block to when given a list input.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="lmblocks.blocks.tokens_and_logits.GetMaxNextToken.label">
<span class="sig-name descname"><span class="pre">label</span></span><a class="headerlink" href="#lmblocks.blocks.tokens_and_logits.GetMaxNextToken.label" title="Link to this definition"></a></dt>
<dd><p>The label shown on the graph. Updates dynamically with parameter changes.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">All</span> <span class="pre">parameters</span> <span class="pre">and</span> <span class="pre">arguments</span> <span class="pre">are</span> <span class="pre">also</span> <span class="pre">exposed</span> <span class="pre">as</span> <span class="pre">attributes,</span> <span class="pre">so</span> <span class="pre">they</span> <span class="pre">can</span> <span class="pre">be</span> <span class="pre">modified</span> <span class="pre">after</span> <span class="pre">initialization.</span></span></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="lmblocks.blocks.tokens_and_logits.SampleNextToken">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">SampleNextToken</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lmblocks.blocks.tokens_and_logits.SampleNextToken" title="Link to this definition"></a></dt>
<dd><p>Increases the sequence length by 1 by sampling a token according to the
logit outputs of the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Keyword Arguments<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>num_repeats</strong> (<em>int</em>) – Number of times to run the sequence. Defaults to 1.</p></li>
<li><p><strong>repeat_until</strong> (<em>StopCriterion</em><em> | </em><em>None</em>) – If set, the block and all inner methods will be repeated until the criterion is met.</p></li>
<li><p><strong>for_all_batches</strong> (<em>bool</em>) – If True, the block will be applied to all batches when given a list input.</p></li>
<li><p><strong>for_batch_idx</strong> (<em>bool</em><em> | </em><em>None</em>) – The index of the batch to apply the block to when given a list input.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="lmblocks.blocks.tokens_and_logits.SampleNextToken.label">
<span class="sig-name descname"><span class="pre">label</span></span><a class="headerlink" href="#lmblocks.blocks.tokens_and_logits.SampleNextToken.label" title="Link to this definition"></a></dt>
<dd><p>The label shown on the graph. Updates dynamically with parameter changes.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">All</span> <span class="pre">parameters</span> <span class="pre">and</span> <span class="pre">arguments</span> <span class="pre">are</span> <span class="pre">also</span> <span class="pre">exposed</span> <span class="pre">as</span> <span class="pre">attributes,</span> <span class="pre">so</span> <span class="pre">they</span> <span class="pre">can</span> <span class="pre">be</span> <span class="pre">modified</span> <span class="pre">after</span> <span class="pre">initialization.</span></span></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="lmblocks.blocks.tokens_and_logits.SampleNextTokenWithFilters">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">SampleNextTokenWithFilters</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">logit_filters_</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lmblocks.blocks.tokens_and_logits.SampleNextTokenWithFilters" title="Link to this definition"></a></dt>
<dd><p>Increases the sequence length by 1 by sampling a token according to the
logit outputs of the model, after applying a given list of logit filters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>logit_filters_</strong> (<em>list</em><em>[</em><em>LogitFilter</em><em>]</em>) – The list of logit filters to apply to the logits before sampling. See <cite>utils.logit_filters</cite>.</p>
</dd>
<dt class="field-even">Keyword Arguments<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>num_repeats</strong> (<em>int</em>) – Number of times to run the sequence. Defaults to 1.</p></li>
<li><p><strong>repeat_until</strong> (<em>StopCriterion</em><em> | </em><em>None</em>) – If set, the block and all inner methods will be repeated until the criterion is met.</p></li>
<li><p><strong>for_all_batches</strong> (<em>bool</em>) – If True, the block will be applied to all batches when given a list input.</p></li>
<li><p><strong>for_batch_idx</strong> (<em>bool</em><em> | </em><em>None</em>) – The index of the batch to apply the block to when given a list input.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="lmblocks.blocks.tokens_and_logits.SampleNextTokenWithFilters.label">
<span class="sig-name descname"><span class="pre">label</span></span><a class="headerlink" href="#lmblocks.blocks.tokens_and_logits.SampleNextTokenWithFilters.label" title="Link to this definition"></a></dt>
<dd><p>The label shown on the graph. Updates dynamically with parameter changes.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">All</span> <span class="pre">parameters</span> <span class="pre">and</span> <span class="pre">arguments</span> <span class="pre">are</span> <span class="pre">also</span> <span class="pre">exposed</span> <span class="pre">as</span> <span class="pre">attributes,</span> <span class="pre">so</span> <span class="pre">they</span> <span class="pre">can</span> <span class="pre">be</span> <span class="pre">modified</span> <span class="pre">after</span> <span class="pre">initialization.</span></span></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="lmblocks.blocks.tokens_and_logits.SequenceBranchExpander">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">SequenceBranchExpander</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">k</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lmblocks.blocks.tokens_and_logits.SequenceBranchExpander" title="Link to this definition"></a></dt>
<dd><p>Expands each sequence with the top-<em>k</em> tokens from a 2D logit matrix. Primarily used in beam search decoding.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>k</strong> (<em>int</em>) – Number of tokens to select per sequence.</p>
</dd>
<dt class="field-even">Keyword Arguments<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>num_repeats</strong> (<em>int</em>) – Number of times to run the sequence. Defaults to 1.</p></li>
<li><p><strong>repeat_until</strong> (<em>StopCriterion</em><em> | </em><em>None</em>) – If set, the block and all inner methods will be repeated until the criterion is met.</p></li>
<li><p><strong>for_all_batches</strong> (<em>bool</em>) – If True, the block will be applied to all batches when given a list input.</p></li>
<li><p><strong>for_batch_idx</strong> (<em>bool</em><em> | </em><em>None</em>) – The index of the batch to apply the block to when given a list input.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="lmblocks.blocks.tokens_and_logits.SequenceBranchExpander.label">
<span class="sig-name descname"><span class="pre">label</span></span><a class="headerlink" href="#lmblocks.blocks.tokens_and_logits.SequenceBranchExpander.label" title="Link to this definition"></a></dt>
<dd><p>The label shown on the graph. Updates dynamically with parameter changes.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">All</span> <span class="pre">parameters</span> <span class="pre">and</span> <span class="pre">arguments</span> <span class="pre">are</span> <span class="pre">also</span> <span class="pre">exposed</span> <span class="pre">as</span> <span class="pre">attributes,</span> <span class="pre">so</span> <span class="pre">they</span> <span class="pre">can</span> <span class="pre">be</span> <span class="pre">modified</span> <span class="pre">after</span> <span class="pre">initialization.</span></span></dt>
<dd></dd></dl>

<p>Example 1:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># x is [&quot;The sky is&quot;]</span>
<span class="c1"># Next best tokens are [&quot;blue&quot;, &quot;grey&quot;, &quot;clear&quot;, &quot;sunny&quot;, ...]</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">SequenceBranchExpander</span><span class="p">(</span><span class="n">k</span><span class="o">=</span><span class="mi">3</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
<span class="c1"># x is now [&quot;The sky is blue&quot;, &quot;The sky is grey&quot;, &quot;The sky is clear&quot;]</span>
</pre></div>
</div>
<p>Example 2:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># x has two sequences: [&quot;The sky is&quot;, &quot;The forest is&quot;]</span>
<span class="c1"># Next best tokens for A: [&quot;blue&quot;, &quot;grey&quot;, &quot;clear&quot;, ...]</span>
<span class="c1"># Next best tokens for B: [&quot;green&quot;, &quot;dense&quot;, &quot;dark&quot;, ...]</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">SequenceBranchExpander</span><span class="p">(</span><span class="n">k</span><span class="o">=</span><span class="mi">2</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
<span class="c1"># x is now [&quot;The sky is blue&quot;, &quot;The sky is grey&quot;, &quot;The forest is green&quot;, &quot;The forest is dense&quot;]</span>
</pre></div>
</div>
<p>This could be followed with a <cite>SequenceSelector</cite> block to select the best sequence(s) from each expanded set.</p>
</dd></dl>

</section>
<section id="module-lmblocks.blocks.batch_modifiers">
<span id="batch-modifiers"></span><h2>Batch Modifiers<a class="headerlink" href="#module-lmblocks.blocks.batch_modifiers" title="Link to this heading"></a></h2>
<p>These blocks modify the structure of a batch of sequences. They may change the number of sequences in a batch, the number of tokens in a sequence, or the tokens themselves.</p>
<dl class="py class">
<dt class="sig sig-object py" id="lmblocks.blocks.batch_modifiers.SequenceSlicer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">SequenceSlicer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lmblocks.blocks.batch_modifiers.SequenceSlicer" title="Link to this definition"></a></dt>
<dd><p>Slices a <cite>SequenceBatch</cite> token-wise (vertically).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>start</strong> (<em>int</em>) – The index to start the slice at.</p></li>
<li><p><strong>end</strong> (<em>int</em><em> | </em><em>None</em>) – The index to end the slice at.</p></li>
</ul>
</dd>
<dt class="field-even">Keyword Arguments<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>num_repeats</strong> (<em>int</em>) – Number of times to run the sequence. Defaults to 1.</p></li>
<li><p><strong>repeat_until</strong> (<em>StopCriterion</em><em> | </em><em>None</em>) – If set, the block and all inner methods will be repeated until the criterion is met.</p></li>
<li><p><strong>for_all_batches</strong> (<em>bool</em>) – If True, the block will be applied to all batches when given a list input.</p></li>
<li><p><strong>for_batch_idx</strong> (<em>bool</em><em> | </em><em>None</em>) – The index of the batch to apply the block to when given a list input.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="lmblocks.blocks.batch_modifiers.SequenceSlicer.label">
<span class="sig-name descname"><span class="pre">label</span></span><a class="headerlink" href="#lmblocks.blocks.batch_modifiers.SequenceSlicer.label" title="Link to this definition"></a></dt>
<dd><p>The label shown on the graph. Updates dynamically with parameter changes.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">All</span> <span class="pre">parameters</span> <span class="pre">and</span> <span class="pre">arguments</span> <span class="pre">are</span> <span class="pre">also</span> <span class="pre">exposed</span> <span class="pre">as</span> <span class="pre">attributes,</span> <span class="pre">so</span> <span class="pre">they</span> <span class="pre">can</span> <span class="pre">be</span> <span class="pre">modified</span> <span class="pre">after</span> <span class="pre">initialization.</span></span></dt>
<dd></dd></dl>

<p>Example (token-wise):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">SequenceBatch</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">]])</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">SequenceSlicer</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
<span class="c1"># x is now [[2, 3], [5, 6], [8, 9]]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="lmblocks.blocks.batch_modifiers.BatchSlicer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">BatchSlicer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lmblocks.blocks.batch_modifiers.BatchSlicer" title="Link to this definition"></a></dt>
<dd><p>Slices a <cite>SequenceBatch</cite> sequence-wise (horizontally).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>start</strong> (<em>int</em>) – The index to start the slice at.</p></li>
<li><p><strong>end</strong> (<em>int</em><em> | </em><em>None</em>) – The index to end the slice at.</p></li>
</ul>
</dd>
<dt class="field-even">Keyword Arguments<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>num_repeats</strong> (<em>int</em>) – Number of times to run the sequence. Defaults to 1.</p></li>
<li><p><strong>repeat_until</strong> (<em>StopCriterion</em><em> | </em><em>None</em>) – If set, the block and all inner methods will be repeated until the criterion is met.</p></li>
<li><p><strong>for_all_batches</strong> (<em>bool</em>) – If True, the block will be applied to all batches when given a list input.</p></li>
<li><p><strong>for_batch_idx</strong> (<em>bool</em><em> | </em><em>None</em>) – The index of the batch to apply the block to when given a list input.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="lmblocks.blocks.batch_modifiers.BatchSlicer.label">
<span class="sig-name descname"><span class="pre">label</span></span><a class="headerlink" href="#lmblocks.blocks.batch_modifiers.BatchSlicer.label" title="Link to this definition"></a></dt>
<dd><p>The label shown on the graph. Updates dynamically with parameter changes.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">All</span> <span class="pre">parameters</span> <span class="pre">and</span> <span class="pre">arguments</span> <span class="pre">are</span> <span class="pre">also</span> <span class="pre">exposed</span> <span class="pre">as</span> <span class="pre">attributes,</span> <span class="pre">so</span> <span class="pre">they</span> <span class="pre">can</span> <span class="pre">be</span> <span class="pre">modified</span> <span class="pre">after</span> <span class="pre">initialization.</span></span></dt>
<dd></dd></dl>

<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">SequenceBatch</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">]])</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">SequenceSlicer</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">0</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
<span class="c1"># x is now [[4, 5, 6], [7, 8, 9]]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="lmblocks.blocks.batch_modifiers.InputTokenRemover">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">InputTokenRemover</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lmblocks.blocks.batch_modifiers.InputTokenRemover" title="Link to this definition"></a></dt>
<dd><p>Removes any input tokens from the <cite>SequenceBatch</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Keyword Arguments<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>num_repeats</strong> (<em>int</em>) – Number of times to run the sequence. Defaults to 1.</p></li>
<li><p><strong>repeat_until</strong> (<em>StopCriterion</em><em> | </em><em>None</em>) – If set, the block and all inner methods will be repeated until the criterion is met.</p></li>
<li><p><strong>for_all_batches</strong> (<em>bool</em>) – If True, the block will be applied to all batches when given a list input.</p></li>
<li><p><strong>for_batch_idx</strong> (<em>bool</em><em> | </em><em>None</em>) – The index of the batch to apply the block to when given a list input.</p></li>
</ul>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">SequenceBatch</span><span class="p">([[</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">]])</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">GetMaxNextToken</span><span class="p">()(</span><span class="n">x</span><span class="p">)</span>
<span class="c1"># x is now [[1, 4], [2, 5], [3, 6]]</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">InputTokenRemover</span><span class="p">()(</span><span class="n">x</span><span class="p">)</span>
<span class="c1"># x is now [[4], [5], [6]]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="lmblocks.blocks.batch_modifiers.RandomSequenceSlicer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">RandomSequenceSlicer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lmblocks.blocks.batch_modifiers.RandomSequenceSlicer" title="Link to this definition"></a></dt>
<dd><p>Slices a <cite>SequenceBatch</cite> token-wise at a randomly chosen index for each sequence.</p>
<dl class="field-list simple">
<dt class="field-odd">Keyword Arguments<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>num_repeats</strong> (<em>int</em>) – Number of times to run the sequence. Defaults to 1.</p></li>
<li><p><strong>repeat_until</strong> (<em>StopCriterion</em><em> | </em><em>None</em>) – If set, the block and all inner methods will be repeated until the criterion is met.</p></li>
<li><p><strong>for_all_batches</strong> (<em>bool</em>) – If True, the block will be applied to all batches when given a list input.</p></li>
<li><p><strong>for_batch_idx</strong> (<em>bool</em><em> | </em><em>None</em>) – The index of the batch to apply the block to when given a list input.</p></li>
</ul>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">SequenceBatch</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">]])</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">RandomSequenceSlicer</span><span class="p">()(</span><span class="n">x</span><span class="p">)</span>
<span class="c1"># x is now [[1, 2], [5, 6, 7]]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="lmblocks.blocks.batch_modifiers.TextInjector">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">TextInjector</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">text</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lmblocks.blocks.batch_modifiers.TextInjector" title="Link to this definition"></a></dt>
<dd><p>Injects a text string into a batch of sequences.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>text</strong> (<em>str</em>) – The text to inject.</p>
</dd>
<dt class="field-even">Keyword Arguments<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>num_repeats</strong> (<em>int</em>) – Number of times to run the sequence. Defaults to 1.</p></li>
<li><p><strong>repeat_until</strong> (<em>StopCriterion</em><em> | </em><em>None</em>) – If set, the block and all inner methods will be repeated until the criterion is met.</p></li>
<li><p><strong>for_all_batches</strong> (<em>bool</em>) – If True, the block will be applied to all batches when given a list input.</p></li>
<li><p><strong>for_batch_idx</strong> (<em>bool</em><em> | </em><em>None</em>) – The index of the batch to apply the block to when given a list input.</p></li>
</ul>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">SequenceBatch</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]])</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">TextInjector</span><span class="p">(</span><span class="s2">&quot;The sky is&quot;</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
<span class="c1"># x is now [[1, 2, 3, 464, 6766,  318],</span>
<span class="c1">#           [4, 5, 6, 464, 6766,  318]]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="lmblocks.blocks.batch_modifiers.SequenceRepeater">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">SequenceRepeater</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lmblocks.blocks.batch_modifiers.SequenceRepeater" title="Link to this definition"></a></dt>
<dd><p>Repeats each sequence in a batch a specified number of times.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>n</strong> (<em>int</em>) – The number of times to repeat each sequence.</p>
</dd>
<dt class="field-even">Keyword Arguments<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>num_repeats</strong> (<em>int</em>) – Number of times to run the sequence. Defaults to 1.</p></li>
<li><p><strong>repeat_until</strong> (<em>StopCriterion</em><em> | </em><em>None</em>) – If set, the block and all inner methods will be repeated until the criterion is met.</p></li>
<li><p><strong>for_all_batches</strong> (<em>bool</em>) – If True, the block will be applied to all batches when given a list input.</p></li>
<li><p><strong>for_batch_idx</strong> (<em>bool</em><em> | </em><em>None</em>) – The index of the batch to apply the block to when given a list input.</p></li>
</ul>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">SequenceBatch</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]])</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">SequenceRepeater</span><span class="p">(</span><span class="mi">2</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
<span class="c1"># x is now [[1, 2], [1, 2], [3, 4], [3, 4]]</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="module-lmblocks.blocks.sequence_selectors">
<span id="sequence-selectors"></span><h2>Sequence Selectors<a class="headerlink" href="#module-lmblocks.blocks.sequence_selectors" title="Link to this heading"></a></h2>
<p>Sequence selector blocks are used to extract sequences from a batch based on a
given objective function (see <cite>utils.objective_functions</cite>).</p>
<p>All sequence selectors have an optional <cite>for_batch_size</cite> parameter. When set,
the block will be applied using this batch size. This is useful in cases where
the starting batch size has been expanded, e.g. in beam search, and the block
needs to be applied to each sub-batch separately. For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># x is SequenceBatch with x.sequence_scores = [-2.0, -1.0, -3.0, -5.0]</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">MaxSequenceSelector</span><span class="p">(</span><span class="n">for_batch_size</span><span class="o">=</span><span class="mi">2</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
<span class="c1"># The batch is divided into 2 sub-batches of size 2:</span>
<span class="c1"># x_1.sequence_scores = [-2.0, -1.0] =&gt; best sequence is -1.0</span>
<span class="c1"># x_2.sequence_scores = [-3.0, -5.0] =&gt; best sequence is -3.0</span>
<span class="c1"># x is now SequenceBatch with 2 sequences</span>
<span class="c1"># x.sequence_scores is now [-1.0, -3.0]</span>
</pre></div>
</div>
<dl class="py class">
<dt class="sig sig-object py" id="lmblocks.blocks.sequence_selectors.MaxSequenceSelector">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">MaxSequenceSelector</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">objective_function=&lt;lmblocks.utils.objective_functions.JointLogProbs</span> <span class="pre">object&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">for_batch_size=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">**kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lmblocks.blocks.sequence_selectors.MaxSequenceSelector" title="Link to this definition"></a></dt>
<dd><p>Selects the sequence with the highest objective function score from a list of sequences.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>objective_function</strong> (<em>ObjectiveFunction</em>) – Objective function to use for scoring sequences.</p></li>
<li><p><strong>for_batch_size</strong> (<em>int</em>) – When set, the block will be applied using this batch size.</p></li>
</ul>
</dd>
<dt class="field-even">Keyword Arguments<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>num_repeats</strong> (<em>int</em>) – Number of times to run the sequence. Defaults to 1.</p></li>
<li><p><strong>repeat_until</strong> (<em>StopCriterion</em><em> | </em><em>None</em>) – If set, the block and all inner methods will be repeated until the criterion is met.</p></li>
<li><p><strong>for_all_batches</strong> (<em>bool</em>) – If True, the block will be applied to all batches when given a list input.</p></li>
<li><p><strong>for_batch_idx</strong> (<em>bool</em><em> | </em><em>None</em>) – The index of the batch to apply the block to when given a list input.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="lmblocks.blocks.sequence_selectors.MaxSequenceSelector.label">
<span class="sig-name descname"><span class="pre">label</span></span><a class="headerlink" href="#lmblocks.blocks.sequence_selectors.MaxSequenceSelector.label" title="Link to this definition"></a></dt>
<dd><p>The label shown on the graph. Updates dynamically with parameter changes.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">All</span> <span class="pre">parameters</span> <span class="pre">and</span> <span class="pre">arguments</span> <span class="pre">are</span> <span class="pre">also</span> <span class="pre">exposed</span> <span class="pre">as</span> <span class="pre">attributes,</span> <span class="pre">so</span> <span class="pre">they</span> <span class="pre">can</span> <span class="pre">be</span> <span class="pre">modified</span> <span class="pre">after</span> <span class="pre">initialization.</span></span></dt>
<dd></dd></dl>

<p>Example 1:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># x is SequenceBatch with 4 sequences</span>
<span class="c1"># x.sequence_scores is [-2.0, -1.0, -3.0, -5.0]</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">MaxSequenceSelector</span><span class="p">()(</span><span class="n">x</span><span class="p">)</span>
<span class="c1"># x now has 1 sequence</span>
<span class="c1"># x.sequence_scores is now [-1.0]</span>
</pre></div>
</div>
<p>Example 2 (with <cite>for_batch_size</cite>):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># x is SequenceBatch with 6 sequences</span>
<span class="c1"># x.sequence_scores is [-2.0, -1.0, -3.0, -6.0, -5.0, -4.0]</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">MaxSequenceSelector</span><span class="p">(</span><span class="n">for_batch_size</span><span class="o">=</span><span class="mi">3</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
<span class="c1"># x now has 2 sequences</span>
<span class="c1"># x.sequence_scores is now [-1.0, -4.0]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="lmblocks.blocks.sequence_selectors.TopKSequenceSelector">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">TopKSequenceSelector</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">k</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">objective_function=&lt;lmblocks.utils.objective_functions.JointLogProbs</span> <span class="pre">object&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">for_batch_size=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">**kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lmblocks.blocks.sequence_selectors.TopKSequenceSelector" title="Link to this definition"></a></dt>
<dd><p>Selects the top-k sequences with the highest objective function scores from a list of sequences.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>k</strong> (<em>int</em>) – Number of sequences to select.</p></li>
<li><p><strong>objective_function</strong> (<em>ObjectiveFunction</em>) – Objective function to use for scoring sequences.</p></li>
<li><p><strong>for_batch_size</strong> (<em>int</em>) – When set, the block will be applied using this batch size.</p></li>
</ul>
</dd>
<dt class="field-even">Keyword Arguments<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>num_repeats</strong> (<em>int</em>) – Number of times to run the sequence. Defaults to 1.</p></li>
<li><p><strong>repeat_until</strong> (<em>StopCriterion</em><em> | </em><em>None</em>) – If set, the block and all inner methods will be repeated until the criterion is met.</p></li>
<li><p><strong>for_all_batches</strong> (<em>bool</em>) – If True, the block will be applied to all batches when given a list input.</p></li>
<li><p><strong>for_batch_idx</strong> (<em>bool</em><em> | </em><em>None</em>) – The index of the batch to apply the block to when given a list input.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="lmblocks.blocks.sequence_selectors.TopKSequenceSelector.label">
<span class="sig-name descname"><span class="pre">label</span></span><a class="headerlink" href="#lmblocks.blocks.sequence_selectors.TopKSequenceSelector.label" title="Link to this definition"></a></dt>
<dd><p>The label shown on the graph. Updates dynamically with parameter changes.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">All</span> <span class="pre">parameters</span> <span class="pre">and</span> <span class="pre">arguments</span> <span class="pre">are</span> <span class="pre">also</span> <span class="pre">exposed</span> <span class="pre">as</span> <span class="pre">attributes,</span> <span class="pre">so</span> <span class="pre">they</span> <span class="pre">can</span> <span class="pre">be</span> <span class="pre">modified</span> <span class="pre">after</span> <span class="pre">initialization.</span></span></dt>
<dd></dd></dl>

<p>Example 1:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># x is SequenceBatch with 4 sequences</span>
<span class="c1"># x.sequence_scores is [-2.0, -1.0, -3.0, -5.0]</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">TopKSequenceSelector</span><span class="p">(</span><span class="n">k</span><span class="o">=</span><span class="mi">2</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
<span class="c1"># x now has 2 sequences</span>
<span class="c1"># x.sequence_scores is now [-1.0, -2.0]</span>
</pre></div>
</div>
<p>Example 2 (with <cite>for_batch_size</cite>):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># x is SequenceBatch with 6 sequences</span>
<span class="c1"># x.sequence_scores is [-2.0, -1.0, -3.0, -6.0, -5.0, -4.0]</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">TopKSequenceSelector</span><span class="p">(</span><span class="n">k</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">for_batch_size</span><span class="o">=</span><span class="mi">3</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
<span class="c1"># x now has 4 sequences</span>
<span class="c1"># x.sequence_scores is now [-1.0, -2.0, -4.0, -5.0]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="lmblocks.blocks.sequence_selectors.UniqueSequenceFilter">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">UniqueSequenceFilter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">for_batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lmblocks.blocks.sequence_selectors.UniqueSequenceFilter" title="Link to this definition"></a></dt>
<dd><p>Removes duplicate sequences from a batch.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>for_batch_size</strong> (<em>int</em>) – When set, the block will be applied using this batch size.</p>
</dd>
<dt class="field-even">Keyword Arguments<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>num_repeats</strong> (<em>int</em>) – Number of times to run the sequence. Defaults to 1.</p></li>
<li><p><strong>repeat_until</strong> (<em>StopCriterion</em><em> | </em><em>None</em>) – If set, the block and all inner methods will be repeated until the criterion is met.</p></li>
<li><p><strong>for_all_batches</strong> (<em>bool</em>) – If True, the block will be applied to all batches when given a list input.</p></li>
<li><p><strong>for_batch_idx</strong> (<em>bool</em><em> | </em><em>None</em>) – The index of the batch to apply the block to when given a list input.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="lmblocks.blocks.sequence_selectors.UniqueSequenceFilter.label">
<span class="sig-name descname"><span class="pre">label</span></span><a class="headerlink" href="#lmblocks.blocks.sequence_selectors.UniqueSequenceFilter.label" title="Link to this definition"></a></dt>
<dd><p>The label shown on the graph. Updates dynamically with parameter changes.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">All</span> <span class="pre">parameters</span> <span class="pre">and</span> <span class="pre">arguments</span> <span class="pre">are</span> <span class="pre">also</span> <span class="pre">exposed</span> <span class="pre">as</span> <span class="pre">attributes,</span> <span class="pre">so</span> <span class="pre">they</span> <span class="pre">can</span> <span class="pre">be</span> <span class="pre">modified</span> <span class="pre">after</span> <span class="pre">initialization.</span></span></dt>
<dd></dd></dl>

<p>Example 1:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># x is [&quot;The sky is&quot;, &quot;The forest is&quot;, &quot;The sky is&quot;]</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">UniqueSequenceFilter</span><span class="p">()(</span><span class="n">x</span><span class="p">)</span>
<span class="c1"># x is now [&quot;The sky is&quot;, &quot;The forest is&quot;]</span>
</pre></div>
</div>
<p>Example 2 (with <cite>for_batch_size</cite>):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># x is [&quot;The&quot;, &quot;The&quot;, &quot;sky&quot;, &quot;The&quot;, &quot;sky&quot;, &quot;is&quot;]</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">UniqueSequenceFilter</span><span class="p">(</span><span class="n">for_batch_size</span><span class="o">=</span><span class="mi">3</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
<span class="c1"># x is now [&quot;The&quot;, &quot;sky&quot;, &quot;The&quot;, &quot;sky&quot;, &quot;is&quot;]</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="module-lmblocks.blocks.list_methods">
<span id="list-methods"></span><h2>List Methods<a class="headerlink" href="#module-lmblocks.blocks.list_methods" title="Link to this heading"></a></h2>
<p>List methods for more complex operations on batches.</p>
<p>These methods are used to split, combine, or otherwise treat batches in
sub-batches. Example usage can be seen in some of the global decoding
strategy implementations.</p>
<dl class="py class">
<dt class="sig sig-object py" id="lmblocks.blocks.list_methods.BatchCloner">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">BatchCloner</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">copies</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lmblocks.blocks.list_methods.BatchCloner" title="Link to this definition"></a></dt>
<dd><p>Clones a batch into a list of sub-batches, each identical to the original.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>copies</strong> (<em>int</em>) – The number of copies to make.</p>
</dd>
<dt class="field-even">Keyword Arguments<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>num_repeats</strong> (<em>int</em>) – Number of times to run the sequence. Defaults to 1.</p></li>
<li><p><strong>repeat_until</strong> (<em>StopCriterion</em><em> | </em><em>None</em>) – If set, the block and all inner methods will be repeated until the criterion is met.</p></li>
<li><p><strong>for_all_batches</strong> (<em>bool</em>) – If True, the block will be applied to all batches when given a list input.</p></li>
<li><p><strong>for_batch_idx</strong> (<em>bool</em><em> | </em><em>None</em>) – The index of the batch to apply the block to when given a list input.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="lmblocks.blocks.list_methods.BatchCloner.label">
<span class="sig-name descname"><span class="pre">label</span></span><a class="headerlink" href="#lmblocks.blocks.list_methods.BatchCloner.label" title="Link to this definition"></a></dt>
<dd><p>The label shown on the graph. Updates dynamically with parameter changes.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">All</span> <span class="pre">parameters</span> <span class="pre">and</span> <span class="pre">arguments</span> <span class="pre">are</span> <span class="pre">also</span> <span class="pre">exposed</span> <span class="pre">as</span> <span class="pre">attributes,</span> <span class="pre">so</span> <span class="pre">they</span> <span class="pre">can</span> <span class="pre">be</span> <span class="pre">modified</span> <span class="pre">after</span> <span class="pre">initialization.</span></span></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="lmblocks.blocks.list_methods.BatchDivider">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">BatchDivider</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sizes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lmblocks.blocks.list_methods.BatchDivider" title="Link to this definition"></a></dt>
<dd><p>Divides a batch of sequences into separate sub-batches.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>size</strong> (<em>int</em>) – The size of the new batches. If not provided, each sequence will become its own sub-batch.</p></li>
<li><p><strong>sizes</strong> (<em>list</em><em>[</em><em>int</em><em>]</em>) – The sizes of the new batches. If provided, <cite>size</cite> is ignored.</p></li>
</ul>
</dd>
<dt class="field-even">Keyword Arguments<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>num_repeats</strong> (<em>int</em>) – Number of times to run the sequence. Defaults to 1.</p></li>
<li><p><strong>repeat_until</strong> (<em>StopCriterion</em><em> | </em><em>None</em>) – If set, the block and all inner methods will be repeated until the criterion is met.</p></li>
<li><p><strong>for_all_batches</strong> (<em>bool</em>) – If True, the block will be applied to all batches when given a list input.</p></li>
<li><p><strong>for_batch_idx</strong> (<em>bool</em><em> | </em><em>None</em>) – The index of the batch to apply the block to when given a list input.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="lmblocks.blocks.list_methods.BatchDivider.label">
<span class="sig-name descname"><span class="pre">label</span></span><a class="headerlink" href="#lmblocks.blocks.list_methods.BatchDivider.label" title="Link to this definition"></a></dt>
<dd><p>The label shown on the graph. Updates dynamically with parameter changes.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">All</span> <span class="pre">parameters</span> <span class="pre">and</span> <span class="pre">arguments</span> <span class="pre">are</span> <span class="pre">also</span> <span class="pre">exposed</span> <span class="pre">as</span> <span class="pre">attributes,</span> <span class="pre">so</span> <span class="pre">they</span> <span class="pre">can</span> <span class="pre">be</span> <span class="pre">modified</span> <span class="pre">after</span> <span class="pre">initialization.</span></span></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="lmblocks.blocks.list_methods.ProbabilisticSequenceAccepter">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ProbabilisticSequenceAccepter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">objective_function=&lt;lmblocks.utils.objective_functions.JointLogProbs</span> <span class="pre">object&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta=1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">**kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lmblocks.blocks.list_methods.ProbabilisticSequenceAccepter" title="Link to this definition"></a></dt>
<dd><p>Accepts sequences between two sub-batches probabilistically based on their
scores. This is used in the BiasedTPS decoding strategy implementation, but
may have other uses.</p>
<p>The acceptance ratio for a sequence is calculated as:</p>
<div class="math notranslate nohighlight">
\[\exp(\beta \cdot (\text{{proposed sequence score}} - \text{{current sequence score}}))\]</div>
<p>for each sequence, where <span class="math notranslate nohighlight">\(\beta\)</span> (beta) is a hyperparameter. Naturally, both
batches must have the same number of sequences.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>objective_function</strong> (<em>ObjectiveFunction</em>) – Objective function to use for scoring sequences.</p></li>
<li><p><strong>beta</strong> (<em>float</em>) – The beta hyperparameter for the acceptance ratio. Higher values exemplify
the importance of the score difference in the acceptance decision, leading
to a faster convergence but reduced exploration.</p></li>
</ul>
</dd>
<dt class="field-even">Keyword Arguments<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>num_repeats</strong> (<em>int</em>) – Number of times to run the sequence. Defaults to 1.</p></li>
<li><p><strong>repeat_until</strong> (<em>StopCriterion</em><em> | </em><em>None</em>) – If set, the block and all inner methods will be repeated until the criterion is met.</p></li>
<li><p><strong>for_all_batches</strong> (<em>bool</em>) – If True, the block will be applied to all batches when given a list input.</p></li>
<li><p><strong>for_batch_idx</strong> (<em>bool</em><em> | </em><em>None</em>) – The index of the batch to apply the block to when given a list input.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="lmblocks.blocks.list_methods.ProbabilisticSequenceAccepter.label">
<span class="sig-name descname"><span class="pre">label</span></span><a class="headerlink" href="#lmblocks.blocks.list_methods.ProbabilisticSequenceAccepter.label" title="Link to this definition"></a></dt>
<dd><p>The label shown on the graph. Updates dynamically with parameter changes.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">All</span> <span class="pre">parameters</span> <span class="pre">and</span> <span class="pre">arguments</span> <span class="pre">are</span> <span class="pre">also</span> <span class="pre">exposed</span> <span class="pre">as</span> <span class="pre">attributes,</span> <span class="pre">so</span> <span class="pre">they</span> <span class="pre">can</span> <span class="pre">be</span> <span class="pre">modified</span> <span class="pre">after</span> <span class="pre">initialization.</span></span></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="lmblocks.blocks.list_methods.ForSpecificBatch">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ForSpecificBatch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">idx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lmblocks.blocks.list_methods.ForSpecificBatch" title="Link to this definition"></a></dt>
<dd><p>Applies a method to a specific batch in a list of batches.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>idx</strong> (<em>int</em>) – The index of the batch to apply the method to.</p></li>
<li><p><strong>method</strong> (<em>Block</em>) – The method to apply to the batch.</p></li>
</ul>
</dd>
<dt class="field-even">Keyword Arguments<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>num_repeats</strong> (<em>int</em>) – Number of times to run the sequence. Defaults to 1.</p></li>
<li><p><strong>repeat_until</strong> (<em>StopCriterion</em><em> | </em><em>None</em>) – If set, the block and all inner methods will be repeated until the criterion is met.</p></li>
<li><p><strong>for_all_batches</strong> (<em>bool</em>) – If True, the block will be applied to all batches when given a list input.</p></li>
<li><p><strong>for_batch_idx</strong> (<em>bool</em><em> | </em><em>None</em>) – The index of the batch to apply the block to when given a list input.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="lmblocks.blocks.list_methods.ForSpecificBatch.label">
<span class="sig-name descname"><span class="pre">label</span></span><a class="headerlink" href="#lmblocks.blocks.list_methods.ForSpecificBatch.label" title="Link to this definition"></a></dt>
<dd><p>The label shown on the graph. Updates dynamically with parameter changes.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">All</span> <span class="pre">parameters</span> <span class="pre">and</span> <span class="pre">arguments</span> <span class="pre">are</span> <span class="pre">also</span> <span class="pre">exposed</span> <span class="pre">as</span> <span class="pre">attributes,</span> <span class="pre">so</span> <span class="pre">they</span> <span class="pre">can</span> <span class="pre">be</span> <span class="pre">modified</span> <span class="pre">after</span> <span class="pre">initialization.</span></span></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="lmblocks.blocks.list_methods.ForAllBatches">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ForAllBatches</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">method</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lmblocks.blocks.list_methods.ForAllBatches" title="Link to this definition"></a></dt>
<dd><p>Applies a method to all batches in a list of batches.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>method</strong> (<em>Block</em>) – The method to apply to the batches.</p>
</dd>
<dt class="field-even">Keyword Arguments<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>num_repeats</strong> (<em>int</em>) – Number of times to run the sequence. Defaults to 1.</p></li>
<li><p><strong>repeat_until</strong> (<em>StopCriterion</em><em> | </em><em>None</em>) – If set, the block and all inner methods will be repeated until the criterion is met.</p></li>
<li><p><strong>for_all_batches</strong> (<em>bool</em>) – If True, the block will be applied to all batches when given a list input.</p></li>
<li><p><strong>for_batch_idx</strong> (<em>bool</em><em> | </em><em>None</em>) – The index of the batch to apply the block to when given a list input.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="lmblocks.blocks.list_methods.ForAllBatches.label">
<span class="sig-name descname"><span class="pre">label</span></span><a class="headerlink" href="#lmblocks.blocks.list_methods.ForAllBatches.label" title="Link to this definition"></a></dt>
<dd><p>The label shown on the graph. Updates dynamically with parameter changes.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">All</span> <span class="pre">parameters</span> <span class="pre">and</span> <span class="pre">arguments</span> <span class="pre">are</span> <span class="pre">also</span> <span class="pre">exposed</span> <span class="pre">as</span> <span class="pre">attributes,</span> <span class="pre">so</span> <span class="pre">they</span> <span class="pre">can</span> <span class="pre">be</span> <span class="pre">modified</span> <span class="pre">after</span> <span class="pre">initialization.</span></span></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-lmblocks.blocks.misc">
<span id="misc"></span><h2>Misc<a class="headerlink" href="#module-lmblocks.blocks.misc" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="lmblocks.blocks.misc.PrintBatchContents">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">PrintBatchContents</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lmblocks.blocks.misc.PrintBatchContents" title="Link to this definition"></a></dt>
<dd><p>Prints the text contents of a <cite>SequenceBatch</cite> to the console.</p>
<dl class="field-list simple">
<dt class="field-odd">Keyword Arguments<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>num_repeats</strong> (<em>int</em>) – Number of times to run the sequence. Defaults to 1.</p></li>
<li><p><strong>repeat_until</strong> (<em>StopCriterion</em><em> | </em><em>None</em>) – If set, the block and all inner methods will be repeated until the criterion is met.</p></li>
<li><p><strong>for_all_batches</strong> (<em>bool</em>) – If True, the block will be applied to all batches when given a list input.</p></li>
<li><p><strong>for_batch_idx</strong> (<em>bool</em><em> | </em><em>None</em>) – The index of the batch to apply the block to when given a list input.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="lmblocks.blocks.misc.PrintBatchContents.label">
<span class="sig-name descname"><span class="pre">label</span></span><a class="headerlink" href="#lmblocks.blocks.misc.PrintBatchContents.label" title="Link to this definition"></a></dt>
<dd><p>The label shown on the graph. Updates dynamically with parameter changes.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">All</span> <span class="pre">parameters</span> <span class="pre">and</span> <span class="pre">arguments</span> <span class="pre">are</span> <span class="pre">also</span> <span class="pre">exposed</span> <span class="pre">as</span> <span class="pre">attributes,</span> <span class="pre">so</span> <span class="pre">they</span> <span class="pre">can</span> <span class="pre">be</span> <span class="pre">modified</span> <span class="pre">after</span> <span class="pre">initialization.</span></span></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="lmblocks.blocks.misc.PrintBatchShape">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">PrintBatchShape</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lmblocks.blocks.misc.PrintBatchShape" title="Link to this definition"></a></dt>
<dd><p>Prints the shape of the input <cite>SequenceBatch</cite> to the console.</p>
<dl class="field-list simple">
<dt class="field-odd">Keyword Arguments<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>num_repeats</strong> (<em>int</em>) – Number of times to run the sequence. Defaults to 1.</p></li>
<li><p><strong>repeat_until</strong> (<em>StopCriterion</em><em> | </em><em>None</em>) – If set, the block and all inner methods will be repeated until the criterion is met.</p></li>
<li><p><strong>for_all_batches</strong> (<em>bool</em>) – If True, the block will be applied to all batches when given a list input.</p></li>
<li><p><strong>for_batch_idx</strong> (<em>bool</em><em> | </em><em>None</em>) – The index of the batch to apply the block to when given a list input.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="lmblocks.blocks.misc.PrintBatchShape.label">
<span class="sig-name descname"><span class="pre">label</span></span><a class="headerlink" href="#lmblocks.blocks.misc.PrintBatchShape.label" title="Link to this definition"></a></dt>
<dd><p>The label shown on the graph. Updates dynamically with parameter changes.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">All</span> <span class="pre">parameters</span> <span class="pre">and</span> <span class="pre">arguments</span> <span class="pre">are</span> <span class="pre">also</span> <span class="pre">exposed</span> <span class="pre">as</span> <span class="pre">attributes,</span> <span class="pre">so</span> <span class="pre">they</span> <span class="pre">can</span> <span class="pre">be</span> <span class="pre">modified</span> <span class="pre">after</span> <span class="pre">initialization.</span></span></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="lmblocks.blocks.misc.PrintBatchListShape">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">PrintBatchListShape</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lmblocks.blocks.misc.PrintBatchListShape" title="Link to this definition"></a></dt>
<dd><p>Prints the shape of the input <cite>list[SequenceBatch]</cite> to the console.</p>
<dl class="field-list simple">
<dt class="field-odd">Keyword Arguments<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>num_repeats</strong> (<em>int</em>) – Number of times to run the sequence. Defaults to 1.</p></li>
<li><p><strong>repeat_until</strong> (<em>StopCriterion</em><em> | </em><em>None</em>) – If set, the block and all inner methods will be repeated until the criterion is met.</p></li>
<li><p><strong>for_all_batches</strong> (<em>bool</em>) – If True, the block will be applied to all batches when given a list input.</p></li>
<li><p><strong>for_batch_idx</strong> (<em>bool</em><em> | </em><em>None</em>) – The index of the batch to apply the block to when given a list input.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="lmblocks.blocks.misc.PrintBatchListShape.label">
<span class="sig-name descname"><span class="pre">label</span></span><a class="headerlink" href="#lmblocks.blocks.misc.PrintBatchListShape.label" title="Link to this definition"></a></dt>
<dd><p>The label shown on the graph. Updates dynamically with parameter changes.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">All</span> <span class="pre">parameters</span> <span class="pre">and</span> <span class="pre">arguments</span> <span class="pre">are</span> <span class="pre">also</span> <span class="pre">exposed</span> <span class="pre">as</span> <span class="pre">attributes,</span> <span class="pre">so</span> <span class="pre">they</span> <span class="pre">can</span> <span class="pre">be</span> <span class="pre">modified</span> <span class="pre">after</span> <span class="pre">initialization.</span></span></dt>
<dd></dd></dl>

</dd></dl>

</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">lmblocks</a></h1>









<search id="searchbox" style="display: none" role="search">
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" placeholder="Search"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script><h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="quickstart.html">Quick Start Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="generate.html">Text and Sequence Generation</a></li>
<li class="toctree-l1"><a class="reference internal" href="models.html">Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="decoding_strategies.html">Decoding Strategies</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Blocks</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#module-lmblocks.blocks.base">Base</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#lmblocks.blocks.base.BlockSequence"><code class="docutils literal notranslate"><span class="pre">BlockSequence</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-lmblocks.blocks.tokens_and_logits">Tokens and Logits</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#lmblocks.blocks.tokens_and_logits.GetMaxNextToken"><code class="docutils literal notranslate"><span class="pre">GetMaxNextToken</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#lmblocks.blocks.tokens_and_logits.SampleNextToken"><code class="docutils literal notranslate"><span class="pre">SampleNextToken</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#lmblocks.blocks.tokens_and_logits.SampleNextTokenWithFilters"><code class="docutils literal notranslate"><span class="pre">SampleNextTokenWithFilters</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#lmblocks.blocks.tokens_and_logits.SequenceBranchExpander"><code class="docutils literal notranslate"><span class="pre">SequenceBranchExpander</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-lmblocks.blocks.batch_modifiers">Batch Modifiers</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#lmblocks.blocks.batch_modifiers.SequenceSlicer"><code class="docutils literal notranslate"><span class="pre">SequenceSlicer</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#lmblocks.blocks.batch_modifiers.BatchSlicer"><code class="docutils literal notranslate"><span class="pre">BatchSlicer</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#lmblocks.blocks.batch_modifiers.InputTokenRemover"><code class="docutils literal notranslate"><span class="pre">InputTokenRemover</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#lmblocks.blocks.batch_modifiers.RandomSequenceSlicer"><code class="docutils literal notranslate"><span class="pre">RandomSequenceSlicer</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#lmblocks.blocks.batch_modifiers.TextInjector"><code class="docutils literal notranslate"><span class="pre">TextInjector</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#lmblocks.blocks.batch_modifiers.SequenceRepeater"><code class="docutils literal notranslate"><span class="pre">SequenceRepeater</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-lmblocks.blocks.sequence_selectors">Sequence Selectors</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#lmblocks.blocks.sequence_selectors.MaxSequenceSelector"><code class="docutils literal notranslate"><span class="pre">MaxSequenceSelector</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#lmblocks.blocks.sequence_selectors.TopKSequenceSelector"><code class="docutils literal notranslate"><span class="pre">TopKSequenceSelector</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#lmblocks.blocks.sequence_selectors.UniqueSequenceFilter"><code class="docutils literal notranslate"><span class="pre">UniqueSequenceFilter</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-lmblocks.blocks.list_methods">List Methods</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#lmblocks.blocks.list_methods.BatchCloner"><code class="docutils literal notranslate"><span class="pre">BatchCloner</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#lmblocks.blocks.list_methods.BatchDivider"><code class="docutils literal notranslate"><span class="pre">BatchDivider</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#lmblocks.blocks.list_methods.ProbabilisticSequenceAccepter"><code class="docutils literal notranslate"><span class="pre">ProbabilisticSequenceAccepter</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#lmblocks.blocks.list_methods.ForSpecificBatch"><code class="docutils literal notranslate"><span class="pre">ForSpecificBatch</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#lmblocks.blocks.list_methods.ForAllBatches"><code class="docutils literal notranslate"><span class="pre">ForAllBatches</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-lmblocks.blocks.misc">Misc</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#lmblocks.blocks.misc.PrintBatchContents"><code class="docutils literal notranslate"><span class="pre">PrintBatchContents</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#lmblocks.blocks.misc.PrintBatchShape"><code class="docutils literal notranslate"><span class="pre">PrintBatchShape</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#lmblocks.blocks.misc.PrintBatchListShape"><code class="docutils literal notranslate"><span class="pre">PrintBatchListShape</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="stop_criteria.html">Stop Criteria</a></li>
<li class="toctree-l1"><a class="reference internal" href="objective_functions.html">Objective Functions</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="decoding_strategies.html" title="previous chapter">Decoding Strategies</a></li>
      <li>Next: <a href="stop_criteria.html" title="next chapter">Stop Criteria</a></li>
  </ul></li>
</ul>
</div>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;2025, Jack Paine, Ed Gillman, Jake Dorman & Jamie Mair.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 8.1.3</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 1.0.0</a>
      
      |
      <a href="_sources/blocks.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>